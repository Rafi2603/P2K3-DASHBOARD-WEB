<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>DASHBOARD P2K3 JASAMARGA</title>
      <link rel="stylesheet" href="styles.css">
      <!-- Tambahkan jQuery -->
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <!-- Tambahkan Select2 -->
      <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/css/select2.min.css" rel="stylesheet" />
      <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/js/select2.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
      <!-- SweetAlert2 -->
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
   </head>
   <body>
      <!-- Navigation Bar -->
      <div class="navbar">
         <ul>
            <li>
               <img src="Logo Jasa Marga.png" alt="Logo Perusahaan" class="navbar-logo">
            </li>
            <li>
               <h1 class="navbar-title">DASHBOARD DATA P2K3</h1>
            </li>
         </ul>
         <button class="logout-btn" onclick="handleLogout()">Logout</button>
      </div>
      <!-- Tab Navigation -->
      <div class="tabs-container">
         <ul class="tabs">
            <li class="tab active" data-tab="struktur-tab">Struktur Organisasi</li>
            <li class="tab" data-tab="personel-tab">Personel Ahli K3</li>
            <li class="tab" data-tab="rekap-tab">Rekap Data K3</li>
            <li class="tab" data-tab="kecelakaan-tab">Kecelakaan Kerja</li>
            <li class="tab" data-tab="kejadian-darurat-tab">Kejadian Darurat</li>
            <li class="tab" data-tab="checklist-k3-tab">Checklist K3</li>
         </ul>
      </div>
      <!-- Tab Content -->
      <div class="tab-content" id="struktur-tab">
         <h1>Struktur Organisasi</h1>
         <div class="search-container">
            <input type="text" id="search-bar-struktur" placeholder="Search Bar">
            <button class="add-data-btn-struktur" id="add-data-btn-struktur">Tambah Data</button>
            <button class="export-csv-btn-struktur" onclick="exportTableToXLSX('struktur-table', 'StrukturOrganisasi.xlsx', [1, 2, 3])">Export Excel</button>
            <button id="delete-selected-btn" class="delete-selected-btn">Delete Selected</button>
         </div>
         <div class="pagination-settings">
            <div class="rows-per-page">
               <label for="rows-per-page">Rows per page:</label>
               <select id="rows-per-page">
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
               </select>
            </div>
            <div id="pagination-container" class="pagination-container"></div>
         </div>
         <table id="struktur-table">
            <thead>
               <tr>
                  <th><input type="checkbox" id="select-all"></th>
                  <!-- Checkbox untuk memilih semua -->
                  <th>Nama</th>
                  <th>Jabatan</th>
                  <th>Posisi</th>
                  <th>Tanggal Input</th>
                  <th>Action Menu</th>
               </tr>
            </thead>
            <tbody id="table-body-struktur">
               <!-- Data akan dimasukkan di sini -->
            </tbody>
         </table>
         <div class="jabatan">
            <h2>1. Ketua</h2>
            <p><strong>Fungsi Pokok:</strong> 
               Memimpin penerapan Sistem Manajemen K3 di lingkungan Kantor Pusat dengan menyelenggarakan kegiatan monitoring berupa pengendalian potensi bahaya, penyuluhan, pelatihan, penelitian dan pengawasan keselamatan dan kesehatan kerja serta kegiatan evaluasi berupa audit K3 dan memberi rekomendasi tindak lanjut hasil audit K3 dengan menggunakan sumber daya yang ada dan berpedoman pada peraturan yang berlaku, agar tercipta lingkungan kerja yang aman dan sehat sesuai dengan tujuan dan kebijakan perusahaan.
            </p>
            <p><strong>Tugas:</strong></p>
            <ul>
               <li>Mengendalikan pencapaian sasaran, strategi pelaksanaan dan kebijakan program - program P2K3 di lingkungan Kantor Pusat dalam rangka tercapainya tujuan P2K3 sesuai ketentuan yang berlaku;</li>
               <li>Memimpin pelaksanaan program kerja K3 dan evaluasi atas pelaksanaan program kerja K3 di lingkungan kantor pusat dengan memperhatikan peraturan yang berlaku serta sasaran program K3 agar program keselamatan dan kesehatan kerja terlaksana dengan baik</li>
               <li>Memimpin kegiatan pengawasan atas pelaksanaan program dan pembuatan sistem keselamatan dan kesehatan kerja di lingkungan Kantor Pusat dengan memperhatikan ketentuan yang berlaku, agar terlaksananya program-program keselamatan dan kesehatan kerja dengan baik</li>
               <li>Melakukan  koordinasi   dengan instansi external / unit  kerja   terkait penanganan tanggap darurat.</li>
            </ul>
            <p><strong>Wewenang:</strong></p>
            <ul>
               <li>Memimpin Rapat P2K3 Kantor Pusat yang dilaksanakan minimal 1 (satu) kali dalam setiap 3 (tiga) bulan</li>
               <li>Menetapkan pertimbangan keputusan dan saran atas berbagai permasalahan dalam pelaksanaan program keselamatan dan kesehatan kerja dengan ruang lingkup pelaksanaan di Kantor Pusat, dalam rangka meningkatkan kualitas pelaksanaan K3 sesuai sasaran</li>
            </ul>
            <p><strong>Tanggung Jawab:</strong></p>
            <ul>
               <li>Mendorong terciptanya lingkungan kerja yang aman dan sehat sesuai dengan syarat-syarat keselamatan dan kesehatan kerja baik mental maupun fisik karyawan, sebagaimana yang diatur Undang-Undang Ketenagakerjaan</li>
               <li>Terlaksananya program-program P2K3  di lingkungan Kantor Pusat sesuai dengan syarat-syarat Keselamatan dan Kesehatan Kerja sebagaimana yang diatur dalam Undang-Undang Ketenagakerjaan</li>
               <li>Mempertanggungjawabkan program-program P2K3 Kantor Pusat dan pelaksanaannya kepada Direksi.</li>
            </ul>
         </div>
         <div class="jabatan">
            <h2>2. Wakil Ketua</h2>
            <p><strong>Fungsi Pokok:</strong>
               Membantu Ketua dalam penerapan Sistem Manajemen K3 di lingkungan Kantor Pusat dengan menyelenggarakan kegiatan monitoring berupa pengendalian potensi bahaya, penyuluhan, pelatihan, penelitian dan pengawasan keselamatan dan kesehatan kerja serta kegiatan evaluasi berupa audit K3 dan memberi rekomendasi tindak lanjut hasil audit K3 dengan menggunakan sumber daya yang ada dan berpedoman pada peraturan yang berlaku, agar tercipta lingkungan kerja yang aman dan sehat sesuai dengan tujuan dan kebijakan perusahaan
            </p>
            <p><strong>Tugas:</strong></p>
            <ul>
               <li>Membantu Ketua dalam pencapaian sasaran, strategi pelaksanaan dan kebijakan program - program P2K3 di lingkungan Kantor Pusat dalam rangka tercapainya tujuan P2K3 sesuai ketentuan yang berlaku</li>
               <li>Melakukan analisis laporan mengenai kondisi keselamatan dan kesehatan kerja di kantor pusat dengan memperhatikan peraturan yang berlaku serta sasaran program K3 agar program keselamatan dan kesehatan kerja terlaksana dengan baik</li>
            </ul>
            <p><strong>Wewenang:</strong></p>
            <ul>
               <li>Menggantikan peran Ketua apabila berhalangan hadir atau diberikan tanggung jawab langsung dalam kegiatan-kegiatan perihal K3</li>
               <li>Menyampaikan keputusan atas permasalahan sesuai yang ditugaskan ketua P2K3</li>
            </ul>
            <p><strong>Tanggung Jawab:</strong>
               Mendorong terciptanya lingkungan kerja yang aman dan sehat sesuai dengan syarat-syarat keselamatan dan kesehatan kerja baik mental maupun fisik karyawan, sebagaimana yang diatur Undang-Undang Ketenagakerjaan
            </p>
         </div>
         <div class="jabatan">
            <h2>3. Sekretaris</h2>
            <p><strong>Fungsi Pokok:</strong> 
               Menyelenggarakan kegiatan - kegiatan pengumpulan dan pengolahan data/ permasalahan keselamatan dan kesehatan kerja, serta melakukan koordinasi semua aktivitas program P2K3 di lingkungan kantor pusat, dengan memperhatikan peraturan yang berlaku.
            </p>
            <p><strong>Tugas:</strong></p>
            <ul>
               <li>Melaksanakan kegiatan-kegiatan pengumpulan data-data penyiapan materi rapat P2K3 dengan memperhatikan ketentuan yang berlaku, agar rapat P2K3 dapat berjalan dengan lancar sesuai tujuan</li>
               <li>Melaksanakan kegiatan-kegiatan pengelolaan administrasi P2K3, dengan memperhatikan ketentuan yang berlaku, agar tercipta kelancaran administrasi P2K3</li>
               <li>Melaksanakan kegiatan perencanaan program-program P2K3, dengan memperhatikan masukan-masukan dan kondisi keselamatan dan kesehatan kerja di Perusahaan, agar tercipta kelancaran program-program P2K3</li>
               <li>Melaksanakan kegiatan koordinasi dengan anggota P2K3 dan unit kerja dengan memperhatikan ketentuan yang berlaku, agar program-program P2K3 dapat berjalan dengan lancar</li>
            </ul>
            <p><strong>Wewenang:</strong></p>
            <ul>
               <li>Memberikan masukan dan rekomendasi mengenai perbaikan sistem dan pelaksanaan program K3 di lingkungan Kantor Pusat dengan memperhatikan ketentuan yang berlaku, dengan tujuan untuk memperbaiki sistem dan kualitas pelaksanaan program keselamatan dan kesehatan</li>
               <li>Menggantikan peran Wakil Ketua apabila berhalangan hadir atau diberikan tanggung jawab langsung dalam kegiatan-kegiatan perihal K3</li>
               <li>Menetapkan jadwal rapat P2K3, dalam rangka pelaksanaan program-program kerja P2K3</li>
               <li>Melakukan komunikasi dengan instansi luar terkait dalam rangka pelaksanaan program kerja P2K3 serta pemenuhan kewajiban perusaha</li>
               <li>Mengendalikan tata persuratan P2K3, dalam rangka tertib administrasi</li>
            </ul>
            <p><strong>Tanggung Jawab:</strong></p>
            <ul>
               <li>Terlaksananya program-program P2K3 di lingkungan kantor pusat</li>
               <li>Terlaksananya evaluasi data/permasalahan keselamatan dan kesehatan kerja di lingkungan kantor pusat</li>
            </ul>
         </div>
         <div class="jabatan">
            <h2>4. Koordinator Tanggap Darurat</h2>
            <p><strong>Fungsi Pokok:</strong></p>
            <ul>
               <li>Mengkoordinir semua unsur yang terkait dengan kegiatan penanggulangan keadaan  darurat di lingkungan kantor pusat</li>
               <li>Membuat   jadwal 	pelatihan Tim Tanggap Darurat   seperti   pemadam kebakaran, bencana alam, sabotase/teror dan kegiatan lain yang termasuk dalam kondisi darurat</li>
               <li>Melakukan  koordinasi dengan unit  kerja terkait untuk menangani laporan tertulis pelaksanaan program P2K3 yang berdampak terhadap pencapaian sasaran kebijakan K3 di lingkungan kantor pusat</li>
               <li>Menyelenggarakan simulasi tanggap darurat 1 (satu) kali dalam setahun</li>
            </ul>
            <p><strong>Wewenang:</strong></p>
            <ul>
               <li>Membuat skenario  penanganan kondisi darurat di lingkungan kantor pusat</li>
               <li>Menyusun tim tanggap darurat di lingkungan kantor pusat</li>
            </ul>
            <p><strong>Tanggung Jawab:</strong></p>
            <ul>
               <li>Memastikan penanganan kondisi darurat di lingkungan kantor pusat dapat dikendalikan secara efektif dan efisien dengan memperhatikan peraturan yang berlaku</li>
               <li>Menyusun laporan penanganan kondisi darurat di lingkungan kantor pusat dan disampaikan kepada Ketua P2K3 Kantor Pusat</li>
            </ul>
         </div>
         <div class="jabatan">
            <h2>5. Tim Tanggap Darurat</h2>
            <p><strong>Fungsi Pokok:</strong>
               Melaksanakan tugas sesuai dengan kewenangan sebagai Ahli K3, Petugas P3K, Safety Officer, dan Security untuk melaksanakan penanganan tanggap darurat di lingkungan kantor pusat.
            </p>
            <p><strong>Tanggung Jawab:</strong></p>
            <ul>
               <li><strong>Ahli Keselamatan dan Kesehatan Kerja (K3)</strong></li>
               <ul>
                  <li>Memastikan proses yang diperlukan untuk Sistem Manajemen K3 ditetapkan, diterapkan, dan dipelihara di masing-masing unit kerja sesuai penempatan tugas serta menyusunnya dalam laporan kepada Ketua P2K3 mengenai kinerja Sistem Manajemen K3 dan peluang untuk perbaikan.</li>
                  <li>Melaksanakan inspeksi dan pemecahan masalah/kendala dalam penerapan Sistem Manajemen K3 di semua unit kerja.</li>
                  <li>Memastikan penggunaan Standar Kerja/Acuan Kerja terkini untuk masing-masing unit kerja.</li>
                  <li>Merencanakan, melaksanakan, serta memantau Program Audit Internal dan turut aktif dalam Tinjauan Manajemen.</li>
                  <li>Turut serta membuat program kerja tahunan yang berkaitan dengan implementasi Sistem Manajemen K3 di lingkungan kantor pusat PT Jasa Marga (Persero) Tbk.</li>
                  <li>Memastikan bahwa Standar Prosedur dan Instruksi Kerja yang telah ditulis dapat diterapkan di lingkungan kerja.</li>
                  <li>Melaksanakan inspeksi Keselamatan Kerja berkala di tempat kerja.</li>
                  <li>Menjalankan prosedur investigasi kecelakaan sesuai dengan arahan Ketua P2K3.</li>
                  <li>Menyiapkan prosedur dan rencana Keselamatan Kerja yang diperlukan (Hazard Identification Risk Assessment & Determining Control).</li>
                  <li>Menyiapkan materi keselamatan dan bahan untuk rapat P2K3 serta menghadiri rapat P2K3.</li>
                  <li>Memberikan penilaian dan laporan kepada Ketua P2K3 tentang kondisi keselamatan kerja secara umum maupun cara kerja yang terkait dengan K3 serta memantau implementasi saran-saran K3 yang dibuat.</li>
                  <li>Menyimpan dan memelihara dokumen sistem manajemen K3 secara tertib, teratur, dan mudah disajikan bila diperlukan.</li>
               </ul>
               <li><strong>Petugas Pertolongan Pertama Pada Kecelakaan (P3K)</strong></li>
               <ul>
                  <li>Melaksanakan Pertolongan Pertama Pada Kecelakaan (P3K) ketika terjadi kecelakaan kerja atau pada situasi tanggap darurat.</li>
               </ul>
               <li><strong>Safety Officer</strong></li>
               <ul>
                  <li>Melaksanakan tugas penanganan kondisi darurat sesuai dengan tugas yang diberikan dan turut membantu pelaksanaan program-program K3 perusahaan.</li>
               </ul>
               <li><strong>Security / Keamanan Kantor Pusat</strong></li>
               <ul>
                  <li>Turut mengamankan sarana dan prasarana K3 perusahaan.</li>
                  <li>Melaporkan dengan segera apabila terjadi kondisi tanggap darurat seperti demo/huru-hara, kebakaran, bencana alam, atau kejadian darurat lainnya kepada koordinator tanggap darurat atau ketua regu pengamanan/security.</li>
                  <li>Membantu pelaksanaan tanggap darurat sebagaimana tertuang dalam SK tanggap darurat kantor pusat.</li>
               </ul>
            </ul>
         </div>
         <div class="jabatan">
            <h2>6. Anggota</h2>
            <p><strong>Fungsi Pokok:</strong>Melaksanakan kegiatan untuk mencapai sasaran program K3 di lingkungan kantor pusat, dengan memperhatikan peraturan yang berlaku</p>
            <p><strong>Uraian Tugas:</strong></p>
            <ul>
               <li>Mengikuti rapat-rapat rutin yang diadakan oleh P2K3, dengan memperhatikan ketentuan yang berlaku, agar program kerja P2K3 dapat berjalan dengan lancar</li>
               <li>Melaksanakan kegiatan yang telah ditetapkan sebagai program K3 di lingkungan kantor pusat dengan memperhatikan ketentuan yang berlaku, agar para Karyawan dapat memahami dan mengerti tujuan K3</li>
               <li>Memberikan saran tindak lanjut terhadap pelaksanaan program-program keselamatan dan kesehatan kerja di lingkungan kantor pusat, dengan memperhatikan ketentuan yang berlaku sesuai dengan ketentuan Undang-Undang Ketenagakerjaan</li>
            </ul>
            <p><strong>Wewenang:</strong>Memberikan usulan perbaikan pelaksanaan program K3 yang dilakukan Perusahaan, dalam rangka kepatuhan terhadap perundang-undangan ketenagakerjaan</p>
            <p><strong>Tanggung Jawab:</strong>Terlaksananya program-program P2K3 di lingkungan kantor pusat dan di unit kerja sesuai penempatan masing-masing anggota</p>
         </div>
      </div>
      <div class="tab-content" id="personel-tab" style="display: none;">
         <h1>Personel Ahli K3 & P3K</h1>
         <div class="search-container">
            <input type="text" id="search-bar-personel" placeholder="Search Bar">
            <button class="add-data-btn-personel" id="add-data-btn-personel">Tambah Data</button>
            <button class="export-csv-btn-personel" onclick="exportTableToXLSX('personel-table', 'PersonelAhliK3.xlsx', [1, 2, 3])">Export Excel</button>
            <button id="delete-selected-btn-personel" class="delete-selected-btn-personel">Delete Selected</button>
         </div>
         <div class="pagination-settings-personel">
            <div class="rows-per-page-personel">
               <label for="rows-per-page-personel">Rows per page:</label>
               <select id="rows-per-page-personel">
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
               </select>
            </div>
            <div id="pagination-container-personel" class="pagination-container"></div>
         </div>
         <table id="personel-table">
            <thead>
               <tr>
                  <th><input type="checkbox" id="select-all-personel"></th>
                  <!-- Checkbox untuk memilih semua -->
                  <th>Nama</th>
                  <th>Keahlian</th>
                  <th>Batas Masa Berlaku</th>
                  <th>Action Menu</th>
               </tr>
            </thead>
            <tbody id="table-body-personel">
               <!-- Data akan dimasukkan di sini -->
            </tbody>
         </table>
      </div>
      <div class="tab-content" id="rekap-tab" style="display: none;">
         <h1>Rekap Data K3</h1>
         <div class="search-container">
            <input type="text" id="search-bar-rekap" placeholder="Search Bar">
            <button class="add-data-btn-rekap" id="add-data-btn-rekap">Tambah Data</button>
            <button class="export-csv-btn-rekap" onclick="exportTableToXLSX('rekap-table', 'RekapDataP2K3.xlsx', [0,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18])">Export Excel</button>
            <button id="delete-selected-btn-rekap" class="delete-selected-btn-rekap">Delete Selected</button>
         </div>
         <div class="pagination-settings-rekap">
            <div class="rows-per-page-rekap">
               <label for="rows-per-page-rekap">Rows per page:</label>
               <select id="rows-per-page-rekap">
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
               </select>
            </div>
            <div id="pagination-container-rekap" class="pagination-container"></div>
         </div>
         <div style="overflow-x: auto;">
            <table id="rekap-table">
               <thead>
                  <tr>
                     <th><input type="checkbox" id="select-all-rekap"></th>
                     <!-- Checkbox untuk memilih semua -->
                     <th data-order="asc">Tahun</th>
                     <th data-order="asc">Bulan</th>
                     <th data-order="asc">Jumlah Karyawan</th>
                     <th data-order="asc">Jumlah Hari Kerja</th>
                     <th data-order="asc">Jumlah Jam Kerja</th>
                     <th data-order="asc">Kecelakaan Berat</th>
                     <th data-order="asc">Kecelakaan Ringan</th>
                     <th data-order="asc">Meninggal (Akibat Kerja)</th>
                     <th data-order="asc">Near Miss</th>
                     <th data-order="asc">Fire Accident</th>
                     <th data-order="asc">Damaged Property</th>
                     <th data-order="asc">Jumlah Hari Hilang</th>
                     <th data-order="asc">Jumlah Hari Tanpa Hilang</th>
                     <th data-order="asc">LTI</th>
                     <th data-order="asc">Man Hour</th>
                     <th data-order="asc">Frequency Rate</th>
                     <th data-order="asc">Severity Rate</th>
                     <th data-order="asc">Inchident rate</th>
                     <th data-order="asc">ATLR</th>
                     <th data-order="asc">Action Menu</th>
                  </tr>
               </thead>
               <tbody id="table-body-rekap">
                  <!-- Data akan dimasukkan di sini -->
               </tbody>
            </table>
         </div>
         <div id="laporan-indikator">
            <h2>Indikator Laporan Kegiatan K3</h2>
            <ul>
               <li>
                  <strong>Jumlah Hari Kerja Tanpa Kehilangan:</strong>
                  <p>Jumlah hari kerja yang berhasil dilewati tanpa adanya kecelakaan kerja yang menyebabkan hari kerja hilang.</p>
                  Rumus: $$\text{Total Pekerja} \times \text{Jumlah Hari Kerja Perusahaan}$$
               </li>
               <li>
                  <strong>Lost Time Injury (LTI):</strong>
                  <p>Jumlah jam kerja yang hilang karena kecelakaan. Angka ini diperoleh dari catatan lama mangkirnya tenaga kerja akibat kecelakaan kerja.</p>
                  Rumus: $$\text{Jumlah Jam Kerja Hilang}$$
               </li>
               <li>
                  <strong>Man Hour (Jam Kerja Tanpa Kehilangan):</strong>
                  <p>Jumlah jam kerja yang berhasil dilewati tanpa adanya kecelakaan kerja yang menyebabkan jam kerja hilang.</p>
                  Rumus: $$\text{Jumlah Karyawan} \times 8 \times \text{Jumlah Hari Kerja}$$
               </li>
               <li>
                  <strong>Frequency Rate (FR):</strong>
                  <p>
                     Tingkat keseringan kecelakaan kerja atau insiden kerja per 1.000.000 jam kerja orang. 
                     Angka ini membantu memantau seberapa sering kecelakaan terjadi.
                  </p>
                  Rumus: $$\text{FR} = \left( \frac{\text{Total Kasus Kecelakaan Kerja}}{\text{Total Jam Kerja}} \right) \times 1.000.000$$
               </li>
               <li>
                  <strong>Severity Rate (SR):</strong>
                  <p>
                     Tingkat keparahan kecelakaan kerja yang dihitung berdasarkan jumlah hari kerja yang hilang akibat kecelakaan kerja 
                     per 1.000.000 jam kerja orang.
                  </p>
                  Rumus: $$\text{SR} = \left( \frac{\text{Total Hari Kerja Hilang}}{\text{Total Jam Kerja}} \right) \times 1.000.000$$
               </li>
               <li>
                  <strong>Incident Rate (IR):</strong>
                  <p>
                     Persentase tingkat terjadinya kecelakaan kerja untuk setiap tenaga kerja.
                  </p>
                  Rumus: $$\text{IR} = \left( \frac{\text{Total Kasus Kecelakaan Kerja}}{\text{Total Tenaga Kerja}} \right) \times 100 \%$$
               </li>
               <li>
                  <strong>Average Time Lost Rate (ATLR):</strong>
                  <p>
                     Rata-rata hilangnya hari kerja karena kecelakaan kerja untuk setiap kasus kecelakaan kerja.
                  </p>
                  Rumus: $$\text{ATLR} = \frac{\text{Total Hari Hilang}}{\text{Total Kasus Kecelakaan Kerja}}$$
               </li>
            </ul>
         </div>
      </div>
      <div class="tab-content" id="kecelakaan-tab" style="display: none;">
         <h1>Kecelakaan Kerja</h1>
         <div class="search-container">
            <input type="text" id="search-bar-kecelakaan" placeholder="Search Bar">
            <button class="add-data-btn-kecelakaan" id="add-data-btn-kecelakaan">Tambah Data</button>
            <button class="export-csv-btn-kecelakaan" onclick="exportTableToXLSX('kecelakaan-table', 'KecelakaanKerja.xlsx', [0,1,2,3,4,5,6,7,8,9])">Export Excel</button>
            <button id="delete-selected-btn-kecelakaan" class="delete-selected-btn-kecelakaan">Delete Selected</button>
         </div>
         <div class="pagination-settings-kecelakaan">
            <div class="rows-per-page-kecelakaan">
               <label for="rows-per-page-kecelakaan">Rows per page:</label>
               <select id="rows-per-page-kecelakaan">
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
               </select>
            </div>
            <div id="pagination-container-kecelakaan" class="pagination-container"></div>
         </div>
         <div style="overflow-x: auto;">
            <table id="kecelakaan-table">
               <thead>
                  <tr>
                     <th><input type="checkbox" id="select-all-kecelakaan"></th>
                     <!-- Checkbox untuk memilih semua -->
                     <th>Tanggal</th>
                     <th>NIK</th>
                     <th>Nama</th>
                     <th>Jabatan</th>
                     <th>Unit</th>
                     <th>Tempat Kejadian</th>
                     <th>Kategori Kecelakaan</th>
                     <th>Tindak Lanjut</th>
                     <th>Perawatan RS</th>
                     <th>Keterangan</th>
                     <th>Action</th>
                  </tr>
               </thead>
               <tbody id="table-body-kecelakaan">
                  <!-- Data akan dimasukkan di sini -->
               </tbody>
            </table>
         </div>
      </div>
      <div class="tab-content" id="kejadian-darurat-tab" style="display: none;">
         <h1>Kejadian Darurat</h1>
         <div class="search-container">
            <input type="text" id="search-bar-kejadian" placeholder="Search Bar">
            <button class="add-data-btn-kejadian" id="add-data-btn-kejadian">Tambah Data</button>
            <button class="export-csv-btn-kejadian" onclick="exportTableWithImages('kejadian-darurat-table', 'KejadianDarurat.xlsx', [0,1,2,3,4])">
            Export Excel
            </button>
            <button id="delete-selected-btn-kejadian" class="delete-selected-btn-kejadian">Delete Selected</button>

         </div>
         <div class="pagination-settings-kejadian">
            <div class="rows-per-page-kejadian">
               <label for="rows-per-page-kejadian">Rows per page:</label>
               <select id="rows-per-page-kejadian">
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
               </select>
            </div>
            <div id="pagination-container-kejadian" class="pagination-container"></div>
         </div>
         <div style="overflow-x: auto;">
            <table id="kejadian-darurat-table">
               <thead>
                  <tr>
                     <th><input type="checkbox" id="select-all-kejadian"></th>
                     <th>Kejadian Darurat</th>
                     <th>Lokasi</th>
                     <th>Kronologi Kejadian</th>
                     <th>Tindak Lanjut</th>
                     <th>Evidence (Gambar/Foto)</th>
                     <th>Action</th>
                  </tr>
               </thead>
               <tbody id="table-body-kejadian">
                  <!-- Data akan dimasukkan di sini -->
               </tbody>
            </table>
         </div>
      </div>


      <div class="tab-content" id="checklist-k3-tab" style="display: none;">
         <h1>Checklist K3</h1>
         <div class="search-container">
             <input type="text" id="search-bar-checklist" placeholder="Search Bar">
             <button class="add-data-btn-checklist" id="add-data-btn-checklist">Tambah Data</button>
             <button class="export-csv-btn-checklist" onclick="exportTableWithImages('checklist-k3-table', 'ChecklistK3.xlsx', [1,2,3,4,5,6,7,8,9,10,11,12,13,14])">
                 Export Excel
             </button>
             <button id="delete-selected-btn-checklist" class="delete-selected-btn-checklist">Delete Selected</button>
         </div>
         <div class="pagination-settings-checklist">
             <div class="rows-per-page-checklist">
                 <label for="rows-per-page-checklist">Rows per page:</label>
                 <select id="rows-per-page-checklist">
                     <option value="5">5</option>
                     <option value="10">10</option>
                     <option value="15">15</option>
                     <option value="20">20</option>
                 </select>
             </div>
             <div id="pagination-container-checklist" class="pagination-container"></div>
         </div>
         <div style="overflow-x: auto;">
             <table id="checklist-k3-table">
                 <thead>
                     <tr>
                        <th><input type="checkbox" id="select-all-checklist"></th>
                         <th>Section</th>
                         <th>Indikator K3</th>
                         <th>Expired Date</th>
                         <th>Checklist Pemeriksaan</th>
                         <th>APAR</th>
                         <th>Rambu APAR</th>
                         <th>Kelengkapan Box Hydrant</th>
                         <th>Ruang Laktasi</th>
                         <th>Ruang P3K</th>
                         <th>Organik</th>
                         <th>Non-Organik</th>
                         <th>Limbah B3</th>
                         <th>Smoking Area</th>
                         <th>DLL</th>
                         <th>Action</th>
                     </tr>
                 </thead>
                 <tbody id="table-body-checklist">
                     <!-- Data akan dimasukkan di sini -->
                 </tbody>
             </table>
         </div>
     </div>
     

      <!-- Modal Tambah Data STRUKTUR -->
      <div id="add-data-modal-struktur" class="modal">
         <div class="modal-content">
            <span class="close" id="close-modal-struktur">&times;</span>
            <h2>Tambah Data Baru</h2>
            <form id="add-data-form-struktur">
               <label for="nama">Nama:</label>
               <input type="text" id="nama" name="nama" required>
               <label for="jabatan">Jabatan:</label>
               <select id="jabatan" name="jabatan" required>
                  <option value="" disabled selected>Pilih Jabatan</option>
               </select>
               <label for="posisi">Posisi:</label>
               <select id="posisi" name="posisi" class="dropdown" required>
                  <option value="" disabled selected>-- Pilih Posisi --</option>
                  <option value="Ketua">Ketua</option>
                  <option value="Wakil Ketua">Wakil Ketua</option>
                  <option value="Sekretaris I">Sekretaris I</option>
                  <option value="Sekretaris II">Sekretaris II</option>
                  <option value="Anggota">Anggota</option>
                  <option value="Koordinator Tanggap Darurat">Koordinator Tanggap Darurat</option>
                  <option value="Tim Tanggap Darurat">Tim Tanggap Darurat</option>
               </select>
               <button type="submit">Tambah</button>
            </form>
         </div>
      </div>
      <!-- Modal Edit Data STRUKTUR -->
<div id="edit-data-modal-struktur" class="modal">
   <div class="modal-content">
      <span class="close" id="close-edit-modal-struktur">&times;</span>
      <h2>Edit Data</h2>
      <form id="edit-data-form-struktur">
         <input type="hidden" id="edit-id" name="struktur_id" />
         
         <label for="edit-nama">Nama:</label>
         <input type="text" id="edit-nama" name="nama" required>
         
         <label for="edit-jabatan">Jabatan:</label>
         <select id="edit-jabatan" name="jabatan" required>
            <option value="" disabled selected>Pilih Jabatan</option>
         </select>
         
         <label for="edit-posisi">Posisi:</label>
         <select id="edit-posisi" name="posisi" class="dropdown" required>
            <option value="" disabled selected>-- Pilih Posisi --</option>
            <option value="Ketua">Ketua</option>
            <option value="Wakil Ketua">Wakil Ketua</option>
            <option value="Sekretaris I">Sekretaris I</option>
            <option value="Sekretaris II">Sekretaris II</option>
            <option value="Anggota">Anggota</option>
            <option value="Koordinator Tanggap Darurat">Koordinator Tanggap Darurat</option>
            <option value="Tim Tanggap Darurat">Tim Tanggap Darurat</option>
         </select>
         
         <button type="submit">Perbarui</button>
      </form>
   </div>
</div>

      <!-- Modal Tambah Data PERSONEL -->
      <div id="add-data-modal-personel" class="modal">
         <div class="modal-content">
            <span class="close" id="close-modal-personel">&times;</span>
            <h2>Tambah Data Personel Ahli K3</h2>
            <form id="add-data-form-personel">
               <label for="nama-personel">Nama:</label>
               <input type="text" id="nama-personel" name="nama" required>
               <label for="keahlian-personel">Keahlian:</label>
               <input type="text" id="keahlian-personel" name="keahlian" required>
               <label for="batas-masa-berlaku-personel">Batas Masa Berlaku:</label>
               <input type="date" id="batas-masa-berlaku-personel" name="batas_masa_berlaku" required>
               <button type="submit">Tambah</button>
            </form>
         </div>
      </div>
      <!-- Modal Edit Data PERSONEL -->
      <div id="edit-data-modal-personel" class="modal">
         <div class="modal-content">
            <span class="close" id="close-edit-modal-personel">&times;</span>
            <h2>Edit Data Personel Ahli K3</h2>
            <form id="edit-data-form-personel">
               <input type="hidden" id="edit-id-personel" name="personel_k3_id" />
               <label for="edit-nama-personel">Nama:</label>
               <input type="text" id="edit-nama-personel" name="nama" required>
               <label for="edit-keahlian-personel">Keahlian:</label>
               <input type="text" id="edit-keahlian-personel" name="keahlian" required>
               <label for="edit-batas-masa-berlaku">Batas Masa Berlaku:</label>
               <input type="date" id="edit-batas-masa-berlaku-personel" name="batas_masa_berlaku" required>
               <button type="submit">Perbarui</button>
            </form>
         </div>
      </div>
      <!-- Modal Tambah Data REKAP-->
      <div id="add-data-modal-rekap" class="modal">
         <div class="modal-content">
            <span class="close" id="close-modal-rekap">&times;</span>
            <h2>Tambah Data Rekap K3</h2>
            <form id="add-data-form-rekap">
               <label for="tahun">Tahun:</label>
               <input type="number" id="tahun" name="tahun" required>
               <label for="bulan">Bulan:</label>
               <select id="bulan" name="bulan" required>
                  <option value="" disabled selected>-- Pilih Bulan --</option>
                  <option value="Januari">Januari</option>
                  <option value="Februari">Februari</option>
                  <option value="Maret">Maret</option>
                  <option value="April">April</option>
                  <option value="Mei">Mei</option>
                  <option value="Juni">Juni</option>
                  <option value="Juli">Juli</option>
                  <option value="Agustus">Agustus</option>
                  <option value="September">September</option>
                  <option value="Oktober">Oktober</option>
                  <option value="November">November</option>
                  <option value="Desember">Desember</option>
               </select>
               <label for="jumlah-karyawan">Jumlah Karyawan:</label>
               <input type="number" id="jumlah-karyawan" name="jumlah_karyawan" required>
               <label for="jumlah-hari-kerja">Jumlah Hari Kerja:</label>
               <input type="number" id="jumlah-hari-kerja" name="jumlah_hari_kerja" required>
               <label for="kecelakaan-berat">Kecelakaan Berat:</label>
               <input type="number" id="kecelakaan-berat" name="kecelakaan_berat" required>
               <label for="kecelakaan-ringan">Kecelakaan Ringan:</label>
               <input type="number" id="kecelakaan-ringan" name="kecelakaan_ringan" required>
               <label for="kecelakaan-meninggal">Kecelakaan Meninggal:</label>
               <input type="number" id="kecelakaan-meninggal" name="kecelakaan_meninggal" required>
               <label for="near-miss">Near Miss:</label>
               <input type="number" id="near-miss" name="near_miss" required>
               <label for="fire-accident">Fire Accident:</label>
               <input type="number" id="fire-accident" name="fire_accident" required>
               <label for="damaged-property">Damaged Property:</label>
               <input type="number" id="damaged-property" name="damaged_property" required>
               <label for="jumlah-hari-hilang">Jumlah Hari Hilang:</label>
               <input type="number" id="jumlah-hari-hilang" name="jumlah_hari_hilang" required>
               <button type="submit">Tambah</button>
            </form>
         </div>
      </div>
      <!-- Modal Update Data REKAP -->
      <div id="edit-data-modal-rekap" class="modal">
         <div class="modal-content">
            <span class="close" id="close-edit-modal-rekap">&times;</span>
            <h2>Update Data Rekap K3</h2>
            <form id="edit-data-form-rekap">
               <input type="hidden" id="edit-id-rekap" name="rekapdata_id">
               <label for="edit-tahun">Tahun:</label>
               <input type="number" id="edit-tahun" name="tahun" required>
               <label for="edit-bulan">Bulan:</label>
               <select id="edit-bulan" name="edit-bulan" required>
                  <option value="" disabled selected>-- Pilih Bulan --</option>
                  <option value="Januari">Januari</option>
                  <option value="Februari">Februari</option>
                  <option value="Maret">Maret</option>
                  <option value="April">April</option>
                  <option value="Mei">Mei</option>
                  <option value="Juni">Juni</option>
                  <option value="Juli">Juli</option>
                  <option value="Agustus">Agustus</option>
                  <option value="September">September</option>
                  <option value="Oktober">Oktober</option>
                  <option value="November">November</option>
                  <option value="Desember">Desember</option>
               </select>
               <label for="edit-jumlah-karyawan">Jumlah Karyawan:</label>
               <input type="number" id="edit-jumlah-karyawan" name="jumlah_karyawan" required>
               <label for="edit-jumlah-hari-kerja">Jumlah Hari Kerja:</label>
               <input type="number" id="edit-jumlah-hari-kerja" name="jumlah_hari_kerja" required>
               <label for="edit-kecelakaan-berat">Kecelakaan Berat:</label>
               <input type="number" id="edit-kecelakaan-berat" name="kecelakaan_berat" required>
               <label for="edit-kecelakaan-ringan">Kecelakaan Ringan:</label>
               <input type="number" id="edit-kecelakaan-ringan" name="kecelakaan_ringan" required>
               <label for="edit-kecelakaan-meninggal">Kecelakaan Meninggal:</label>
               <input type="number" id="edit-kecelakaan-meninggal" name="kecelakaan_meninggal" required>
               <label for="edit-near-miss">Near Miss:</label>
               <input type="number" id="edit-near-miss" name="near_miss" required>
               <label for="edit-fire-accident">Fire Accident:</label>
               <input type="number" id="edit-fire-accident" name="fire_accident" required>
               <label for="edit-damaged-property">Damaged Property:</label>
               <input type="number" id="edit-damaged-property" name="damaged_property" required>
               <label for="edit-jumlah-hari-hilang">Jumlah Hari Hilang:</label>
               <input type="number" id="edit-jumlah-hari-hilang" name="jumlah_hari_hilang" required>
               <button type="submit">Update</button>
            </form>
         </div>
      </div>
      <!-- Modal Tambah Data Kecelakaan -->
      <div id="add-data-modal-kecelakaan" class="modal">
         <div class="modal-content">
            <span class="close" id="close-modal-kecelakaan">&times;</span>
            <h2>Tambah Data Kecelakaan Kerja</h2>
            <form id="add-data-form-kecelakaan">
               <label for="tanggal">Tanggal:</label>
               <input type="date" id="tanggal" name="tanggal" required>
               <label for="nik">NIK:</label>
               <input type="text" id="nik" name="nik" required>
               <label for="nama">Nama:</label>
               <input type="text" id="nama-kecelakaan" name="nama" required>
               <label for="jabatan">Jabatan:</label>
               <input type="text" id="jabatan-kecelakaan" name="jabatan" required>
               <label for="unit">Unit:</label>
               <input type="text" id="unit" name="unit">
               <label for="tempat_kejadian">Tempat Kejadian:</label>
               <textarea id="tempat_kejadian" name="tempat_kejadian"></textarea>
               <label for="kategori_kecelakaan">Kategori Kecelakaan:</label>
               <select id="kategori_kecelakaan" name="kategori_kecelakaan" required>
                  <option value="" disabled selected>-- Pilih Kategori Kecelakaan --</option>
                  <option value="Kecelakaan Ringan">Kecelakaan Ringan</option>
                  <option value="Kecelakaan Berat">Kecelakaan Berat</option>
                  <option value="Kecelakaan Fatal">Kecelakaan Fatal</option>
               </select>
               <label for="tindak_lanjut">Tindak Lanjut:</label>
               <textarea id="tindak_lanjut" name="tindak_lanjut"></textarea>
               <label for="perawatan_rs">Perawatan RS:</label>
               <input type="date" id="perawatan_rs" name="perawatan_rs">
               <label for="keterangan">Keterangan:</label>
               <textarea id="keterangan" name="keterangan"></textarea>
               <button type="submit">Tambah</button>
            </form>
         </div>
      </div>
      <!-- Modal Update Data Kecelakaan -->
      <div id="edit-data-modal-kecelakaan" class="modal">
         <div class="modal-content">
            <span class="close" id="close-edit-modal-kecelakaan">&times;</span>
            <h2>Update Data Kecelakaan Kerja</h2>
            <form id="edit-data-form-kecelakaan">
               <input type="hidden" id="edit-id-kecelakaan" name="kecelakaankerja_id">
               <label for="edit-tanggal">Tanggal:</label>
               <input type="date" id="edit-tanggal" name="tanggal" required>
               <label for="edit-nik">NIK:</label>
               <input type="text" id="edit-nik" name="nik" required>
               <label for="edit-nama">Nama:</label>
               <input type="text" id="edit-nama-kecelakaan" name="nama" required>
               <label for="edit-jabatan">Jabatan:</label>
               <input type="text" id="edit-jabatan-kecelakaan" name="jabatan" required>
               <label for="edit-unit">Unit:</label>
               <input type="text" id="edit-unit" name="unit">
               <label for="edit-tempat_kejadian">Tempat Kejadian:</label>
               <textarea id="edit-tempat_kejadian" name="tempat_kejadian"></textarea>
               <label for="edit-kategori_kecelakaan">Kategori Kecelakaan:</label>
               <input type="text" id="edit-kategori_kecelakaan" name="kategori_kecelakaan" required>
               <label for="edit-tindak_lanjut">Tindak Lanjut:</label>
               <textarea id="edit-tindak_lanjut" name="tindak_lanjut"></textarea>
               <label for="edit-perawatan_rs">Perawatan RS:</label>
               <input type="date" id="edit-perawatan_rs" name="perawatan_rs">
               <label for="edit-keterangan">Keterangan:</label>
               <textarea id="edit-keterangan" name="keterangan"></textarea>
               <button type="submit">Update</button>
            </form>
         </div>
      </div>
      <!-- Modal Tambah Data Kejadian Darurat -->
      <div id="add-data-modal-kejadian" class="modal">
         <div class="modal-content">
            <span class="close" id="close-modal-kejadian">&times;</span>
            <h2>Tambah Data Kejadian Darurat</h2>
            <form id="add-data-form-kejadian">
               <label for="kejadian_darurat">Kejadian Darurat:</label>
               <input type="text" id="kejadian-darurat" name="kejadian_darurat" required>
               <label for="lokasi">Lokasi:</label>
               <input type="text" id="lokasi" name="lokasi" required>
               <label for="kronologi_kejadian">Kronologi Kejadian:</label>
               <textarea id="kronologi-kejadian" name="kronologi_kejadian" required></textarea>
               <label for="tindak_lanjut">Tindak Lanjut:</label>
               <textarea id="tindak-lanjut" name="tindak_lanjut" required></textarea>
               <label for="evidence">Evidence (Gambar/Foto):</label>
               <input type="file" id="evidence" name="evidence" accept=".jpg, .jpeg, .png">
               <button type="submit">Tambah</button>
            </form>
         </div>
      </div>
      <!-- Modal Update Data Kejadian Darurat -->
      <div id="edit-data-modal-kejadian" class="modal">
         <div class="modal-content">
            <span class="close" id="close-edit-modal-kejadian">&times;</span>
            <h2>Update Data Kejadian Darurat</h2>
            <form id="edit-data-form-kejadian">
               <input type="hidden" id="edit-id-kejadian" name="kejadian_id">
               <label for="edit-kejadian-darurat">Kejadian Darurat:</label>
               <input type="text" id="edit-kejadian-darurat" name="kejadian_darurat" required>
               <label for="edit-lokasi">Lokasi:</label>
               <input type="text" id="edit-lokasi" name="lokasi" required>
               <label for="edit-kronologi-kejadian">Kronologi Kejadian:</label>
               <textarea id="edit-kronologi-kejadian" name="kronologi_kejadian" required></textarea>
               <label for="edit-tindak-lanjut">Tindak Lanjut:</label>
               <textarea id="edit-tindak-lanjut" name="tindak_lanjut" required></textarea>
               <label for="edit-evidence">Evidence (Gambar/Foto):</label>
               <input type="file" id="edit-evidence" name="evidence" accept=".jpg, .jpeg, .png, .pdf">
               <button type="submit">Update</button>
            </form>
         </div>
      </div>

<!-- Modal Tambah Data Checklist K3 -->
<div id="add-data-modal-checklist" class="modal">
   <div class="modal-content">
      <span class="close" id="close-modal-checklist">&times;</span>
      <h2>Tambah Data Checklist K3</h2>
      <form id="add-data-form-checklist">
         <label for="section">Section:</label>
         <input type="text" id="section" name="section">
         <label for="indikator_k3">Indikator K3:</label>
         <input type="text" id="indikator-k3" name="indikator_k3">
         <label for="expired_date">Expired Date:</label>
         <input type="date" id="expired-date" name="expired_date">
         <label for="checklist_pemeriksaan">Checklist Pemeriksaan:</label>
         <input type="file" id="checklist-pemeriksaan" name="checklist_pemeriksaan" accept=".jpg, .jpeg, .png, .pdf">
         <label for="apar">APAR:</label>
         <input type="file" id="apar" name="apar" accept=".jpg, .jpeg, .png, .pdf">
         <label for="rambu_apar">Rambu APAR:</label>
         <input type="file" id="rambu-apar" name="rambu_apar" accept=".jpg, .jpeg, .png, .pdf">
         <label for="kelengkapan_box_hydrant">Kelengkapan Box Hydrant:</label>
         <input type="file" id="kelengkapan-box-hydrant" name="kelengkapan_box_hydrant" accept=".jpg, .jpeg, .png, .pdf">
         <label for="ruang_laktasi">Ruang Laktasi:</label>
         <input type="file" id="ruang-laktasi" name="ruang_laktasi" accept=".jpg, .jpeg, .png, .pdf">
         <label for="ruang_p3k">Ruang P3K:</label>
         <input type="file" id="ruang-p3k" name="ruang_p3k" accept=".jpg, .jpeg, .png, .pdf">
         <label for="organik">Organik:</label>
         <input type="file" id="organik" name="organik" accept=".jpg, .jpeg, .png, .pdf">
         <label for="non_organik">Non-Organik:</label>
         <input type="file" id="non-organik" name="non_organik" accept=".jpg, .jpeg, .png, .pdf">
         <label for="limbah_b3">Limbah B3:</label>
         <input type="file" id="limbah-b3" name="limbah_b3" accept=".jpg, .jpeg, .png, .pdf">
         <label for="smoking_area">Smoking Area:</label>
         <input type="file" id="smoking-area" name="smoking_area" accept=".jpg, .jpeg, .png, .pdf">
         <label for="dll">Lain-lain:</label>
         <input type="file" id="dll" name="dll" accept=".jpg, .jpeg, .png, .pdf">
         <button type="submit">Tambah</button>
      </form>
   </div>
</div>

<!-- Modal Update Data Checklist K3 -->
<div id="edit-data-modal-checklist" class="modal">
   <div class="modal-content">
      <span class="close" id="close-edit-modal-checklist">&times;</span>
      <h2>Update Data Checklist K3</h2>
      <form id="edit-data-form-checklist">
         <input type="hidden" id="edit-checklist-id" name="checklist_id">
         <label for="edit-section">Section:</label>
         <input type="text" id="edit-section" name="section">
         <label for="edit-indikator-k3">Indikator K3:</label>
         <input type="text" id="edit-indikator-k3" name="indikator_k3">
         <label for="edit-expired-date">Expired Date:</label>
         <input type="date" id="edit-expired-date" name="expired_date">
         <label for="edit-checklist-pemeriksaan">Checklist Pemeriksaan:</label>
         <input type="file" id="edit-checklist-pemeriksaan" name="checklist_pemeriksaan" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-apar">APAR:</label>
         <input type="file" id="edit-apar" name="apar" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-rambu-apar">Rambu APAR:</label>
         <input type="file" id="edit-rambu-apar" name="rambu_apar" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-kelengkapan-box-hydrant">Kelengkapan Box Hydrant:</label>
         <input type="file" id="edit-kelengkapan-box-hydrant" name="kelengkapan_box_hydrant" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-ruang-laktasi">Ruang Laktasi:</label>
         <input type="file" id="edit-ruang-laktasi" name="ruang_laktasi" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-ruang-p3k">Ruang P3K:</label>
         <input type="file" id="edit-ruang-p3k" name="ruang_p3k" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-organik">Organik:</label>
         <input type="file" id="edit-organik" name="organik" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-non-organik">Non-Organik:</label>
         <input type="file" id="edit-non-organik" name="non_organik" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-limbah-b3">Limbah B3:</label>
         <input type="file" id="edit-limbah-b3" name="limbah_b3" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-smoking-area">Smoking Area:</label>
         <input type="file" id="edit-smoking-area" name="smoking_area" accept=".jpg, .jpeg, .png, .pdf">
         <label for="edit-dll">Lain-lain:</label>
         <input type="file" id="edit-dll" name="dll" accept=".jpg, .jpeg, .png, .pdf">
         <button type="submit">Update</button>
      </form>
   </div>
</div>


      <script>
         // Fungsi Tab Navigation
         document.addEventListener("DOMContentLoaded", () => {
           const tabs = document.querySelectorAll(".tab");
           const tabContents = document.querySelectorAll(".tab-content");
         
           tabs.forEach((tab) => {
             tab.addEventListener("click", () => {
               tabs.forEach((t) => t.classList.remove("active"));
               tabContents.forEach((content) => (content.style.display = "none"));
         
               tab.classList.add("active");
               document.getElementById(tab.getAttribute("data-tab")).style.display = "block";
             });
           });
         });
         
         // Fungsi Logout
         function handleLogout() {
           alert("Logout berhasil");
           window.location.href = "/public/index.html";
         }
      </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
      <script>
         function exportTableToXLSX(tableId, filename, selectedColumns) {
           const table = document.getElementById(tableId); // Ambil tabel berdasarkan ID
           const rows = table.rows; // Ambil semua baris di tabel
         
           const data = []; // Array untuk menyimpan data yang akan diekspor
           for (let i = 0; i < rows.length; i++) {
             const row = rows[i];
             const rowData = [];
         
             selectedColumns.forEach((colIndex) => {
               const cell = row.cells[colIndex];
         
               // Jika kolom adalah gambar (cek tag <img>), konversi menjadi teks
               if (cell.querySelector("img")) {
                 const img = cell.querySelector("img");
                 rowData.push(img.alt || "Gambar tidak tersedia"); // Gunakan teks alternatif (alt) atau teks default
               } else {
                 rowData.push(cell.innerText); // Ambil teks dari kolom lain
               }
             });
         
             data.push(rowData); // Tambahkan data ke array
           }
         
           // Buat workbook dan worksheet baru dengan data yang difilter
           const wb = XLSX.utils.book_new();
           const ws = XLSX.utils.aoa_to_sheet(data); // Konversi array menjadi worksheet
           XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
         
           XLSX.writeFile(wb, filename); // Simpan file dengan nama tertentu
         }
         
      </script>
      <script>
         async function exportTableWithImages(tableId, filename, selectedColumns) {
         const table = document.getElementById(tableId); // Ambil tabel berdasarkan ID
         const rows = table.rows; // Ambil semua baris di tabel
         //const ExcelJS = await import("exceljs"); // Impor ExcelJS (untuk memastikan file script modern)
         
         const ExcelJS = window.ExcelJS;
         
         
         const workbook = new ExcelJS.Workbook(); // Buat workbook baru
         const worksheet = workbook.addWorksheet("Kejadian Darurat"); // Tambahkan worksheet baru
         
         const imageData = []; // Array untuk menyimpan data gambar
         
         // Loop melalui setiap baris untuk mengambil data dan gambar
         for (let i = 0; i < rows.length; i++) {
           const row = rows[i];
           const rowData = [];
         
           selectedColumns.forEach((colIndex) => {
             const cell = row.cells[colIndex];
         
             if (cell.querySelector("img")) {
               const img = cell.querySelector("img");
               const imgSrc = img.src; // URL gambar
               rowData.push("Gambar"); // Tambahkan placeholder teks ke tabel
         
               // Simpan data gambar
               imageData.push({
                 row: i + 1, // Baris Excel (Excel mulai dari 1)
                 col: colIndex + 1, // Kolom Excel
                 imgSrc, // URL gambar
               });
             } else {
               rowData.push(cell.innerText); // Ambil teks dari sel lainnya
             }
           });
         
           worksheet.addRow(rowData); // Tambahkan data baris ke worksheet
         }
         
         // Tambahkan gambar ke worksheet
         for (const imgInfo of imageData) {
           const { row, col, imgSrc } = imgInfo;
         
           // Ambil gambar sebagai Blob
           const response = await fetch(imgSrc);
           const buffer = await response.arrayBuffer();
         
           // Tambahkan gambar ke workbook
           const imageId = workbook.addImage({
             buffer,
             extension: "png", // Atau format lain seperti jpg
           });
         
           // Atur gambar di worksheet
           worksheet.addImage(imageId, {
             tl: { col: col - 1, row: row - 1 }, // Posisi gambar di Excel
             ext: { width: 100, height: 100 }, // Ukuran gambar
           });
         }
         
         // Simpan file Excel
         const buffer = await workbook.xlsx.writeBuffer();
         const blob = new Blob([buffer], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
         const url = URL.createObjectURL(blob);
         const a = document.createElement("a");
         a.href = url;
         a.download = filename;
         a.click();
         }
         
      </script>
      <script>
         $(document).ready(function() {
           // Terapkan Select2 pada dropdown dengan class 'searchable-dropdown'
           $('.searchable-dropdown').select2({
             placeholder: "-- Pilih Posisi --",
             allowClear: true,
             width: '100%' // Dropdown menyesuaikan lebar elemen induknya
           });
         });
      </script>
      <script type="text/javascript" async
         src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="dropdown-data.js"></script>
      <script src="script.js"></script>
      <script src="rekap-data.js"></script>
   </body>
</html>